# iOS Tasks - Детальный план

## Epic 1: Базовая структура проекта

### Task 1.1: Инициализация iOS проекта
**Описание:** Создание базовой структуры SwiftUI приложения
**Подзадачи:**
- [ ] Создать Xcode проект с SwiftUI
- [ ] Настроить Bundle ID и Team
- [ ] Создать структуру каталогов (App, Modules, Services, Persistence)
- [ ] Настроить SwiftLint
- [ ] Добавить базовые зависимости (SPM)

**Критерии готовности:**
- [ ] Проект собирается без ошибок
- [ ] SwiftLint настроен и работает
- [ ] Структура каталогов создана
- [ ] Базовые зависимости добавлены

**Тесты:**
- [ ] Test project build
- [ ] Test SwiftLint rules
- [ ] Test dependency resolution

### Task 1.2: Настройка CoreData
**Описание:** Создание модели данных для кэширования курсов
**Подзадачи:**
- [ ] Создать CoreData модель (.xcdatamodeld)
- [ ] Определить RateEntity с полями (code, value, updated_at)
- [ ] Создать CoreDataStack
- [ ] Настроить persistent container
- [ ] Добавить базовые CRUD операции

**Критерии готовности:**
- [ ] CoreData модель создана
- [ ] CRUD операции работают
- [ ] Миграции настроены
- [ ] Производительность оптимизирована

**Тесты:**
- [ ] Test CoreData operations
- [ ] Test data persistence
- [ ] Test migration scenarios
- [ ] Test performance

## Epic 2: Основные экраны

### Task 2.1: Главный экран (MainListView)
**Описание:** Экран со списком валют и конвертером
**Подзадачи:**
- [ ] Создать MainListView с SwiftUI
- [ ] Реализовать список валют (List)
- [ ] Добавить TextField для ввода суммы
- [ ] Реализовать логику конвертации
- [ ] Добавить pull-to-refresh
- [ ] Показать дату обновления курсов

**Критерии готовности:**
- [ ] Список валют отображается
- [ ] Конвертация работает мгновенно
- [ ] Pull-to-refresh обновляет курсы
- [ ] UI адаптивный и красивый
- [ ] Поддержка темной/светлой темы

**Тесты:**
- [ ] Test currency list display
- [ ] Test conversion calculation
- [ ] Test pull-to-refresh
- [ ] Test UI responsiveness

### Task 2.2: Экран добавления валют (AddCurrencyView)
**Описание:** Экран для добавления новых валют в список
**Подзадачи:**
- [ ] Создать AddCurrencyView
- [ ] Реализовать поиск валют
- [ ] Добавить секцию "Популярные валюты"
- [ ] Реализовать алфавитный список всех валют
- [ ] Добавить анимации при выборе

**Критерии готовности:**
- [ ] Поиск работает быстро
- [ ] Популярные валюты отображаются
- [ ] Выбор валюты работает
- [ ] Анимации плавные

**Тесты:**
- [ ] Test currency search
- [ ] Test currency selection
- [ ] Test navigation
- [ ] Test animations

### Task 2.3: Экран настроек (SettingsView)
**Описание:** Экран настроек приложения
**Подзадачи:**
- [ ] Создать SettingsView
- [ ] Добавить переключатель темной темы
- [ ] Добавить секцию Premium
- [ ] Добавить информацию о приложении
- [ ] Добавить ссылки на политики

**Критерии готовности:**
- [ ] Переключение темы работает
- [ ] Секция Premium отображается
- [ ] Информация о приложении корректна
- [ ] Ссылки работают

**Тесты:**
- [ ] Test theme switching
- [ ] Test settings persistence
- [ ] Test navigation to policies

## Epic 3: Сетевой слой

### Task 3.1: RatesService
**Описание:** Сервис для работы с API курсов валют
**Подзадачи:**
- [ ] Создать RatesService
- [ ] Реализовать GET /rates запрос
- [ ] Добавить обработку ошибок
- [ ] Реализовать кэширование
- [ ] Добавить retry логику

**Критерии готовности:**
- [ ] Запросы к API работают
- [ ] Ошибки обрабатываются корректно
- [ ] Кэширование работает
- [ ] Retry логика настроена

**Тесты:**
- [ ] Test API requests
- [ ] Test error handling
- [ ] Test caching
- [ ] Test retry logic

### Task 3.2: AnalyticsService
**Описание:** Сервис для отправки аналитических событий
**Подзадачи:**
- [ ] Создать AnalyticsService
- [ ] Реализовать POST /stats запрос
- [ ] Добавить буферизацию событий
- [ ] Реализовать batch отправку
- [ ] Добавить офлайн режим

**Критерии готовности:**
- [ ] События отправляются
- [ ] Буферизация работает
- [ ] Batch отправка работает
- [ ] Офлайн режим работает

**Тесты:**
- [ ] Test event sending
- [ ] Test event buffering
- [ ] Test batch sending
- [ ] Test offline mode

## Epic 4: Монетизация

### Task 4.1: Интеграция AdMob
**Описание:** Добавление рекламных баннеров
**Подзадачи:**
- [ ] Добавить Google Mobile Ads SDK
- [ ] Создать BannerAdView
- [ ] Настроить AdMob App ID
- [ ] Добавить тестовые рекламные блоки
- [ ] Интегрировать в главный экран

**Критерии готовности:**
- [ ] Реклама отображается
- [ ] Тестовые баннеры работают
- [ ] Реклама скрывается для Premium
- [ ] Производительность не страдает

**Тесты:**
- [ ] Test ad display
- [ ] Test ad loading
- [ ] Test premium hiding
- [ ] Test performance impact

### Task 4.2: StoreKit2 интеграция
**Описание:** Реализация подписки Premium
**Подзадачи:**
- [ ] Добавить StoreKit2
- [ ] Создать PaywallView
- [ ] Настроить Product ID
- [ ] Реализовать покупку подписки
- [ ] Добавить восстановление покупок
- [ ] Интеграция с серверной валидацией

**Критерии готовности:**
- [ ] Paywall отображается
- [ ] Покупка работает
- [ ] Восстановление работает
- [ ] Серверная валидация работает

**Тесты:**
- [ ] Test paywall display
- [ ] Test subscription purchase
- [ ] Test purchase restoration
- [ ] Test server validation

## Epic 5: Офлайн функциональность

### Task 5.1: Офлайн режим
**Описание:** Обеспечение работы без интернета
**Подзадачи:**
- [ ] Реализовать проверку подключения
- [ ] Настроить офлайн индикаторы
- [ ] Кэширование курсов в CoreData
- [ ] Очередь событий для отправки
- [ ] Синхронизация при появлении сети

**Критерии готовности:**
- [ ] Приложение работает офлайн
- [ ] Индикаторы офлайн режима
- [ ] Кэш курсов работает
- [ ] Синхронизация работает

**Тесты:**
- [ ] Test offline functionality
- [ ] Test cache operations
- [ ] Test sync on reconnect
- [ ] Test offline indicators

### Task 5.2: Фоновое обновление
**Описание:** Обновление курсов в фоне
**Подзадачи:**
- [ ] Настроить BackgroundTasks
- [ ] Реализовать BGAppRefreshTask
- [ ] Обновление курсов в фоне
- [ ] Обработка ограничений iOS

**Критерии готовности:**
- [ ] Фоновое обновление работает
- [ ] Ограничения iOS соблюдены
- [ ] Энергопотребление оптимизировано

**Тесты:**
- [ ] Test background refresh
- [ ] Test iOS limitations
- [ ] Test battery usage

## Epic 6: Push уведомления

### Task 6.1: Регистрация push токенов
**Описание:** Настройка push уведомлений
**Подзадачи:**
- [ ] Запросить разрешение на уведомления
- [ ] Получить push токен
- [ ] Отправить токен на сервер
- [ ] Обработать ответы на уведомления

**Критерии готовности:**
- [ ] Разрешение запрашивается
- [ ] Токен получается
- [ ] Токен отправляется на сервер
- [ ] Уведомления обрабатываются

**Тесты:**
- [ ] Test permission request
- [ ] Test token registration
- [ ] Test notification handling

## Epic 7: UI/UX и производительность

### Task 7.1: Анимации и переходы
**Описание:** Добавление плавных анимаций
**Подзадачи:**
- [ ] Анимации переходов между экранами
- [ ] Анимации обновления данных
- [ ] Анимации появления/скрытия рекламы
- [ ] Haptic feedback

**Критерии готовности:**
- [ ] Анимации плавные
- [ ] Производительность не страдает
- [ ] Haptic feedback работает

**Тесты:**
- [ ] Test animation smoothness
- [ ] Test performance impact
- [ ] Test haptic feedback

### Task 7.2: Accessibility
**Описание:** Обеспечение доступности
**Подзадачи:**
- [ ] Поддержка VoiceOver
- [ ] Поддержка Dynamic Type
- [ ] Контрастность цветов
- [ ] Accessibility labels

**Критерии готовности:**
- [ ] VoiceOver работает
- [ ] Dynamic Type поддерживается
- [ ] Контрастность соответствует стандартам

**Тесты:**
- [ ] Test VoiceOver navigation
- [ ] Test Dynamic Type scaling
- [ ] Test color contrast

## Epic 8: Тестирование

### Task 8.1: Unit тесты
**Описание:** Покрытие кода unit тестами
**Подзадачи:**
- [ ] Настроить XCTest
- [ ] Тесты для сервисов
- [ ] Тесты для ViewModels
- [ ] Тесты для CoreData операций
- [ ] Моки для сетевых запросов

**Критерии готовности:**
- [ ] Покрытие кода ≥60%
- [ ] Все тесты проходят
- [ ] Моки настроены

**Тесты:**
- [ ] Test coverage report
- [ ] Test execution time
- [ ] Test reliability

### Task 8.2: UI тесты
**Описание:** Автоматизированное тестирование UI
**Подзадачи:**
- [ ] Настроить XCUITest
- [ ] Тесты основных пользовательских сценариев
- [ ] Тесты навигации
- [ ] Тесты конвертации валют

**Критерии готовности:**
- [ ] Основные сценарии покрыты
- [ ] UI тесты стабильны
- [ ] Тесты выполняются быстро

### Task 8.3: Performance тесты
**Описание:** Тестирование производительности
**Подзадачи:**
- [ ] Измерение времени запуска
- [ ] Тестирование памяти
- [ ] Тестирование батареи
- [ ] Профилирование

**Критерии готовности:**
- [ ] Время запуска <0.5с
- [ ] Потребление памяти <120МБ
- [ ] Батарея не разряжается быстро

## Epic 9: Подготовка к релизу

### Task 9.1: App Store подготовка
**Описание:** Подготовка к публикации в App Store
**Подзадачи:**
- [ ] Настроить App Store Connect
- [ ] Создать скриншоты
- [ ] Написать описание приложения
- [ ] Настроить TestFlight
- [ ] Подготовить метаданные

**Критерии готовности:**
- [ ] App Store Connect настроен
- [ ] Скриншоты готовы
- [ ] Описание написано
- [ ] TestFlight работает

### Task 9.2: Финальное тестирование
**Описание:** Комплексное тестирование перед релизом
**Подзадачи:**
- [ ] Тестирование на реальных устройствах
- [ ] Тестирование различных iOS версий
- [ ] Тестирование различных размеров экранов
- [ ] Тестирование в различных условиях сети

**Критерии готовности:**
- [ ] Все устройства поддерживаются
- [ ] Все iOS версии работают
- [ ] Все размеры экранов поддерживаются
- [ ] Стабильная работа в различных условиях 