# üöÄ –°–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è Convertik

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–ø–ª–æ—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É** - –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SSH –∫–ª—é—á –∏–ª–∏ –ø–∞—Ä–æ–ª—å
2. **rsync** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
3. **Docker –∏ docker-compose** - —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–¥–ª—è –±—ç–∫–µ–Ω–¥–∞)
4. **–§–∞–π–ª `.env`** - —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –¥–µ–ø–ª–æ—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp .env.example .env
```

### 2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env`

```bash
# SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
DEPLOY_HOST=ponravilos.ru
DEPLOY_USER=root

# –ü—É—Ç–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
DEPLOY_BACKEND_PATH=/opt/convertik
DEPLOY_FRONTEND_PATH=/opt/www

# –î–æ–º–µ–Ω —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
DEPLOY_FRONTEND_DOMAIN=convertik.ponravilos.ru

# SSH –∫–ª—é—á (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π ~/.ssh/id_rsa)
# DEPLOY_SSH_KEY=~/.ssh/id_rsa

# –ü–æ—Ä—Ç SSH (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)
# DEPLOY_SSH_PORT=22
```

### 3. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ `.env.production` –¥–ª—è –±—ç–∫–µ–Ω–¥–∞

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `backend/.env.production` –Ω–∞ –æ—Å–Ω–æ–≤–µ `backend/env.production.example`:
```bash
cd backend
cp env.production.example .env.production
nano .env.production  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```

**–í–∞–∂–Ω–æ:** –§–∞–π–ª `backend/.env.production` –±—É–¥–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ.

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–µ–ø–ª–æ–π –≤—Å–µ–≥–æ (—Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ + –±—ç–∫–µ–Ω–¥)

```bash
./deploy.sh
```

–∏–ª–∏

```bash
./deploy.sh all
```

### –î–µ–ø–ª–æ–π —Ç–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥–∞

```bash
./deploy.sh backend
```

### –î–µ–ø–ª–æ–π —Ç–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
./deploy.sh frontend
```

## üì¶ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç

### –î–µ–ø–ª–æ–π –±—ç–∫–µ–Ω–¥–∞:

1. ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –±—ç–∫–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `rsync`
2. ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç `.env.production` –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ)
3. ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ—Ç `deploy.sh` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –∫–æ—Ç–æ—Ä—ã–π:
   - –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
   - –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã
   - –í—ã–ø–æ–ª–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –î–µ–ø–ª–æ–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:

1. ‚úÖ –°–æ–∑–¥–∞–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ `rsync`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∞–π—Ç–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–æ–º–µ–Ω)

## üîç –ß—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

### –ë—ç–∫–µ–Ω–¥:
- `.git/`
- `__pycache__/`, `*.pyc`
- `.env`, `.env.production` (–∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)
- `venv/`
- `.pytest_cache/`
- `*.log`

### –§—Ä–æ–Ω—Ç–µ–Ω–¥:
- `.git/`
- `README.md`

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±—ç–∫–µ–Ω–¥–∞:
```bash
ssh $DEPLOY_USER@$DEPLOY_HOST 'cd /opt/convertik && docker-compose -f docker-compose.production.yml logs -f'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
```bash
ssh $DEPLOY_USER@$DEPLOY_HOST 'cd /opt/convertik && docker-compose -f docker-compose.production.yml ps'
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±—ç–∫–µ–Ω–¥–∞:
```bash
ssh $DEPLOY_USER@$DEPLOY_HOST 'cd /opt/convertik && docker-compose -f docker-compose.production.yml restart'
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ `.env` —Ñ–∞–π–ª –Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- ‚úÖ `.env.production` –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SSH –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ SSH –∫–ª—é—á–µ–π –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## ‚ö†Ô∏è Troubleshooting

### –û—à–∏–±–∫–∞: "DEPLOY_HOST –Ω–µ –∑–∞–¥–∞–Ω –≤ .env"
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª `.env` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `DEPLOY_HOST` –∑–∞–ø–æ–ª–Ω–µ–Ω–∞

### –û—à–∏–±–∫–∞: "Permission denied (publickey)"
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ SSH –∫–ª—é—á –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –∫–ª—é—á—É –≤ `DEPLOY_SSH_KEY` –≤ `.env`

### –û—à–∏–±–∫–∞: ".env.production –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ"
- –°–∫—Ä–∏–ø—Ç –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π `backend/.env.production`
- –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ, —Å–æ–∑–¥–∞–π—Ç–µ –µ–≥–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—Ä—É—á–Ω—É—é:
  ```bash
  ssh $DEPLOY_USER@$DEPLOY_HOST
  cd /opt/convertik
  cp env.production.example .env.production
  nano .env.production
  ```

### –ë—ç–∫–µ–Ω–¥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose -f docker-compose.production.yml logs`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `.env.production` –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø–æ—Ä—Ç—ã –Ω–µ –∑–∞–Ω—è—Ç—ã –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π –Ω–∞ –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä:
```bash
# 1. –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª
cp .env.example .env
nano .env

# 2. –°–æ–∑–¥–∞–π—Ç–µ .env.production –¥–ª—è –±—ç–∫–µ–Ω–¥–∞
cd backend
cp env.production.example .env.production
nano .env.production

# 3. –ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –≤—Å–µ
cd ..
./deploy.sh
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
```bash
./deploy.sh frontend
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –±—ç–∫–µ–Ω–¥–∞:
```bash
./deploy.sh backend
```

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
/opt/convertik/          # –ë—ç–∫–µ–Ω–¥
‚îú‚îÄ‚îÄ app/
‚îú‚îÄ‚îÄ alembic/
‚îú‚îÄ‚îÄ docker-compose.production.yml
‚îú‚îÄ‚îÄ deploy.sh
‚îú‚îÄ‚îÄ .env.production
‚îî‚îÄ‚îÄ ...

/opt/www/                # –§—Ä–æ–Ω—Ç–µ–Ω–¥
‚îú‚îÄ‚îÄ index.html
‚îú‚îÄ‚îÄ privacy.html
‚îú‚îÄ‚îÄ terms.html
‚îú‚îÄ‚îÄ data.html
‚îú‚îÄ‚îÄ assets/
‚îî‚îÄ‚îÄ ...
```

---

**–ì–æ—Ç–æ–≤–æ! üéâ** –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ –¥–µ–ø–ª–æ–∏—Ç—å Convertik –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π!
